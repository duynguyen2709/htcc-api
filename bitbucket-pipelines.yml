image: maven:3-jdk-8

pipelines:
  default:
    - parallel:
      - step:
         caches:
           - maven
         script: 
           - cd htcc-gateway-service/
           - mvn -B package
      - step:
         caches:
           - maven
         script: 
           - cd htcc-employee-service/
           - mvn -B package
    - parallel:
      - step:
         script: 
           - mkdir -p ~/.ssh
           - cd ssh/
           - cat my_known_hosts >> ~/.ssh/known_hosts
           - (umask  077 ; echo $KEY_DEV_1 | base64 --decode > ~/.ssh/id_rsa)
           - ssh root@167.179.80.90 'echo "connected to 167.179.80.90 as $USER"'
      - step:
         script: 
           - mkdir -p ~/.ssh
           - cd ssh/
           - cat my_known_hosts >> ~/.ssh/known_hosts
           - (umask  077 ; echo $KEY_DEV_1 | base64 --decode > ~/.ssh/id_rsa)
           - ssh root@108.61.162.225 'echo "connected to 108.61.162.225 as $USER"'
